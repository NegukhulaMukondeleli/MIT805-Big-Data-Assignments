C:\MIT805_A1_Data\scripts>

C:\MIT805_A1_Data\scripts>pip install pandas pyarrow
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pandas in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (2.2.3)
Requirement already satisfied: pyarrow in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (21.0.0)
Requirement already satisfied: numpy>=1.26.0 in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (from pandas) (2.2.6)
Requirement already satisfied: python-dateutil>=2.8.2 in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (from pandas) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (from pandas) (2025.2)
Requirement already satisfied: six>=1.5 in c:\users\mukondelelinegukhula\appdata\local\packages\pythonsoftwarefoundation.python.3.12_qbz5n2kfra8p0\localcache\local-packages\python312\site-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)

[notice] A new release of pip is available: 25.0.1 -> 25.2
[notice] To update, run: C:\Users\MukondeleliNegukhula\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe -m pip install --upgrade pip

C:\MIT805_A1_Data\scripts>python convert2024_csv.py
Creating 2024 CSV using local conversion...
Processing 2024-01...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-01.parquet...
  Converting to CSV...
  Converted to CSV: 2964624 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-01
Processing 2024-02...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-02.parquet...
  Converting to CSV...
  Converted to CSV: 3007526 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-02
Processing 2024-03...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-03.parquet...
  Converting to CSV...
  Converted to CSV: 3582628 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-03
Processing 2024-04...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-04.parquet...
  Converting to CSV...
  Converted to CSV: 3514289 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-04
Processing 2024-05...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-05.parquet...
  Converting to CSV...
  Converted to CSV: 3723833 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-05
Processing 2024-06...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-06.parquet...
  Converting to CSV...
  Converted to CSV: 3539193 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-06
Processing 2024-07...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-07.parquet...
  Converting to CSV...
  Converted to CSV: 3076903 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-07
Processing 2024-08...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-08.parquet...
  Converting to CSV...
  Converted to CSV: 2979183 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-08
Processing 2024-09...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-09.parquet...
  Converting to CSV...
  Converted to CSV: 3633030 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-09
Processing 2024-10...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-10.parquet...
  Converting to CSV...
  Converted to CSV: 3833771 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-10
Processing 2024-11...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-11.parquet...
  Converting to CSV...
  Converted to CSV: 3646369 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-11
Processing 2024-12...
  Downloading /user/MukondeleliNegukhula/nyc_taxi/raw/yellow_tripdata_2024-12.parquet...
  Converting to CSV...
  Converted to CSV: 3668371 rows
  Uploading to HDFS...
  âœ… Successfully processed 2024-12
âœ… All 2024 files processed!
Final output in HDFS: /user/MukondeleliNegukhula/nyc_taxi/csv_2024/

Final output files:

C:\MIT805_A1_Data\scripts>python combine_csv_files.py
Combining 2024 CSV files and saving to /MIT805A1 folder...
Listing CSV files in HDFS...
Found 12 CSV files to process
Processing yellow_tripdata_2024-01.csv...
  Reading yellow_tripdata_2024-01.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 2964624 rows with filedate: 2024-01-01
Processing yellow_tripdata_2024-02.csv...
  Reading yellow_tripdata_2024-02.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3007526 rows with filedate: 2024-02-01
Processing yellow_tripdata_2024-03.csv...
  Reading yellow_tripdata_2024-03.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3582628 rows with filedate: 2024-03-01
Processing yellow_tripdata_2024-04.csv...
  Reading yellow_tripdata_2024-04.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3514289 rows with filedate: 2024-04-01
Processing yellow_tripdata_2024-05.csv...
  Reading yellow_tripdata_2024-05.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3723833 rows with filedate: 2024-05-01
Processing yellow_tripdata_2024-06.csv...
  Reading yellow_tripdata_2024-06.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3539193 rows with filedate: 2024-06-01
Processing yellow_tripdata_2024-07.csv...
  Reading yellow_tripdata_2024-07.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3076903 rows with filedate: 2024-07-01
Processing yellow_tripdata_2024-08.csv...
  Reading yellow_tripdata_2024-08.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 2979183 rows with filedate: 2024-08-01
Processing yellow_tripdata_2024-09.csv...
  Reading yellow_tripdata_2024-09.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3633030 rows with filedate: 2024-09-01
Processing yellow_tripdata_2024-10.csv...
  Reading yellow_tripdata_2024-10.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3833771 rows with filedate: 2024-10-01
Processing yellow_tripdata_2024-11.csv...
  Reading yellow_tripdata_2024-11.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3646369 rows with filedate: 2024-11-01
Processing yellow_tripdata_2024-12.csv...
  Reading yellow_tripdata_2024-12.csv...
C:\MIT805_A1_Data\scripts\combine_csv_files.py:79: DtypeWarning: Columns (6) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(local_csv)
  âœ… Added 3668371 rows with filedate: 2024-12-01
Combining all data...
Saving combined file with 41169720 rows...
Uploading to /MIT805A1/nyc_taxi_2024_combined_with_date.csv...
âœ… Successfully created combined file: /MIT805A1/nyc_taxi_2024_combined_with_date.csv
Verifying upload...

ðŸ“Š Combined File Statistics:
Total rows: 41,169,720
Total columns: 20
Date range: 2024-01-01 to 2024-12-01
File size: 4561.73 MB

Sample data with filedate:
     filedate  VendorID tpep_pickup_datetime tpep_dropoff_datetime
0  2024-01-01         2  2024-01-01 00:57:55   2024-01-01 01:17:43
1  2024-01-01         1  2024-01-01 00:03:00   2024-01-01 00:09:36
2  2024-01-01         1  2024-01-01 00:17:06   2024-01-01 00:35:01
3  2024-01-01         1  2024-01-01 00:36:38   2024-01-01 00:44:56
4  2024-01-01         1  2024-01-01 00:46:51   2024-01-01 00:52:57

First few rows with the new filedate column:
     filedate  VendorID tpep_pickup_datetime tpep_dropoff_datetime  passenger_count
0  2024-01-01         2  2024-01-01 00:57:55   2024-01-01 01:17:43              1.0
1  2024-01-01         1  2024-01-01 00:03:00   2024-01-01 00:09:36              1.0
2  2024-01-01         1  2024-01-01 00:17:06   2024-01-01 00:35:01              1.0
3  2024-01-01         1  2024-01-01 00:36:38   2024-01-01 00:44:56              1.0
4  2024-01-01         1  2024-01-01 00:46:51   2024-01-01 00:52:57              1.0

C:\MIT805_A1_Data\scripts>